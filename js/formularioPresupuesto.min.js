document.addEventListener('DOMContentLoaded',function(){var miForm=document.getElementById('formularioContacto');var miBoton=document.getElementById("btnEnviar");if(!miForm)return;miBoton.addEventListener("click",(evento)=>{evento.preventDefault();miForm.dispatchEvent(new Event('submit'))});miForm.addEventListener('submit',function(e){e.preventDefault();let formValid=validar();if(formValid){alert('¡Formulario validado correctamente! Procediendo al envío...')}else{const primerError=document.querySelector('.is-invalid');if(primerError){primerError.focus()}}});function validar(){var name=document.getElementById('inputName');var surname=document.getElementById('inputSurname');var email=document.getElementById('inputEmail');var phone=document.getElementById('inputPhone');var privacity=document.getElementById('checkboxPrivacidad');var tablaProductos=document.getElementById('tabla-productos');var opcionesEnvios=document.getElementById('opciones-envios');const regexName=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]{2,15}$/;const regexSurname=/^[a-zA-ZáéíóúÁÉÍÓÚñÑ\s]{2,40}$/;const regexEmail=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;const regexPhone=/^\d{9}$/;let formValid=!0;if(!validarCampoTexto(name,regexName,'El nombre debe tener entre 2 y 15 letras/espacios y no puede contener números.'))formValid=!1;if(!validarCampoTexto(surname,regexSurname,'Los apellidos deben tener entre 2 y 40 letras/espacios y no puede contener números.'))formValid=!1;if(!validarCampoTexto(email,regexEmail,'Ingresa un formato de correo electrónico válido (ej: nombre@dominio.com).'))formValid=!1;if(!validarCampoTexto(phone,regexPhone,'Ingresa un número de teléfono válido (9 dígitos numéricos).'))formValid=!1;if(!validarSeleccionProductos(tablaProductos))formValid=!1;if(!validarSeleccionEnvio(opcionesEnvios))formValid=!1;if(!validarCheckbox(privacity))formValid=!1;return formValid}
function validarCampoTexto(inputElement,regex,mensajeError){const value=inputElement.value.trim();const idSufix=inputElement.id.substring(5);const errorElement=document.getElementById('error'+idSufix);if(!errorElement)return!0;if(value===''||!regex.test(value)){errorElement.textContent=mensajeError;errorElement.classList.remove('d-none');inputElement.classList.add('is-invalid');inputElement.classList.remove('is-valid');return!1}else{errorElement.classList.add('d-none');errorElement.textContent='';inputElement.classList.remove('is-invalid');inputElement.classList.add('is-valid');return!0}}
function validarSeleccionProductos(tablaProductos){let totalUnidades=0;tablaProductos.querySelectorAll('.unidades').forEach(input=>{totalUnidades+=parseInt(input.value)||0});const errorElement=document.getElementById('errorProductos');if(!errorElement)return!0;if(totalUnidades>0){errorElement.classList.add('d-none');return!0}else{errorElement.textContent='Debes seleccionar al menos 1 unidad de café de la variedad que desees.';errorElement.classList.remove('d-none');return!1}}
function validarSeleccionEnvio(opcionesEnvios){const isValid=opcionesEnvios.value!=="";const errorElement=document.getElementById('errorEnvios');if(!errorElement)return!0;if(!isValid){errorElement.textContent='Debes seleccionar un tipo de envío.';errorElement.classList.remove('d-none');opcionesEnvios.classList.add('is-invalid');return!1}else{errorElement.classList.add('d-none');opcionesEnvios.classList.remove('is-invalid');opcionesEnvios.classList.add('is-valid');return!0}}
function validarCheckbox(checkboxElement){const isValid=checkboxElement.checked;const errorElement=document.getElementById('errorPrivacity');if(!errorElement)return!0;if(!isValid){errorElement.textContent='Debe aceptar la política de privacidad para poder enviar el formulario.';errorElement.classList.remove('d-none');return!1}else{errorElement.classList.add('d-none');return!0}}
actualizarTotales()});document.addEventListener('DOMContentLoaded',function(){const tablaProductos=document.getElementById("tabla-productos");const opcionesEnvios=document.getElementById("opciones-envios");const opcionTarjeta=document.getElementById("tarjetaRegalo");const opcionEmbalaje=document.getElementById("embalajeRegalo");const totalElement=document.getElementById("totalGeneral");function actualizarTotales(){let subtotalProductos=0;tablaProductos.querySelectorAll('tr[data-precio]').forEach(fila=>{const precio=parseFloat(fila.dataset.precio);const unidadesInput=fila.querySelector('.unidades');const unidades=parseInt(unidadesInput.value)||0;const totalParcial=precio*unidades;fila.querySelector('.precio-total').textContent=totalParcial.toFixed(2)+"€";subtotalProductos+=totalParcial});let descuentoEnvio=0;if(opcionesEnvios.value){descuentoEnvio=subtotalProductos*parseFloat(opcionesEnvios.value)}
const totalFinal=subtotalProductos-descuentoEnvio;totalElement.textContent=totalFinal.toFixed(2)+"€"}
tablaProductos.querySelectorAll('.unidades').forEach(input=>{input.addEventListener('change',actualizarTotales);input.addEventListener('keyup',actualizarTotales)});opcionesEnvios.addEventListener('change',actualizarTotales);opcionTarjeta.addEventListener('change',actualizarTotales);opcionEmbalaje.addEventListener('change',actualizarTotales);actualizarTotales()})